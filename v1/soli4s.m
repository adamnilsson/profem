function [stress, strain] = soli4s(ex, ey, ez, D, ed)
for i = 1:size(ex,1)

    C=[ones(4,1) ex(i,:)' ey(i,:)' ez(i,:)'];
    G=([0 1 0 0; 0 0 1 0; 0 0 0 1]/C)';

    % J=[ex(1,2:4)-ex(1,1); ey(1,2:4)-ey(1,1); ez(1,2:4)-ez(1,1)];
    % G = [-1 -1 -1;1 0 0;0 1 0;0 0 1]/J;

    Bt=[G(1,1)  0 0 G(2,1) 0 0 G(3,1) 0 0 G(4,1) 0 0; 0 G(1,2) 0 0 G(2,2) 0 0 G(3,2) 0 0 G(4,2) 0; 0 0 G(1,3) 0 0 G(2,3) 0 0 G(3,3) 0 0 G(4,3); G(1,2) G(1,1) 0 G(2,2) G(2,1) 0 G(3,2) G(3,1) 0 G(4,2) G(4,1) 0; G(1,3) 0 G(1,1) G(2,3) 0 G(2,1) G(3,3) 0 G(3,1) G(4,3) 0 G(4,1); 0 G(1,3) G(1,2) 0 G(2,3) G(2,2) 0 G(3,3) G(3,2) 0 G(4,3) G(4,2)];

    strain(i,:) = ed(i,:)*Bt';
end
    stress = strain*D;

